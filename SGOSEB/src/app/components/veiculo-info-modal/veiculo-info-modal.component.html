<!-- Arquivo: viatura-info-modal.component.html -->

<ion-card class="modal-flutuante">
  <ion-card-header [color]="viatura.situacao_os_aberta === 'ABERTA' ? 'danger' : 'success'">
    <ion-button fill="clear" class="fechar-btn" (click)="fecharModal()">
      <ion-icon name="close-circle" color="light"></ion-icon>
    </ion-button>

    <ion-card-title>{{ viatura.modelo || viatura.marca_da_viatura }}</ion-card-title>
    <ion-card-subtitle>Placa: {{ viatura.placa_eb | titlecase }}</ion-card-subtitle>
  </ion-card-header>

  <ion-card-content>
    <ion-list lines="full">
      <!-- Se OS Aberta -->
      <ng-container *ngIf="viatura.situacao_os_aberta === 'ABERTA'">
        <ion-item>
          <ion-icon name="document-text-outline" slot="start" color="danger"></ion-icon>
          <ion-label>
            <h3>Número OS</h3>
            <p>{{ viatura.id_os }}</p>
          </ion-label>
        </ion-item>

        <ion-item>
          <ion-icon name="alert-circle-outline" slot="start" color="danger"></ion-icon>
          <ion-label>
            <h3>Problema Apresentado</h3>
            <p>{{ viatura.problema_apresentado }}</p>
          </ion-label>
        </ion-item>

        <ion-item>
          <ion-icon name="build-outline" slot="start" color="danger"></ion-icon>
          <ion-label>
            <h3>Sistema Afetado</h3>
            <p>{{ viatura.sistema_afetado }}</p>
          </ion-label>
        </ion-item>

        <ion-item>
          <ion-icon name="warning-outline" slot="start" color="danger"></ion-icon>
          <ion-label>
            <h3>Causa da Avaria</h3>
            <p>{{ viatura.causa_da_avaria }}</p>
          </ion-label>
        </ion-item>

        <ion-item>
          <ion-icon name="speedometer-outline" slot="start" color="danger"></ion-icon>
          <ion-label>
            <h3>Hodômetro</h3>
            <p>{{ viatura.hodometro }} km</p>
          </ion-label>
        </ion-item>
<!-- 
        <ion-item>
          <ion-icon name="person-outline" slot="start" color="danger"></ion-icon>
          <ion-label>
            <h3>Usuário que Abriu</h3>
            <p>{{ viatura.usuario }}</p>
          </ion-label>
        </ion-item> -->

        <ion-item>
          <ion-icon name="home-outline" slot="start" color="danger"></ion-icon>
          <ion-label>
            <h3>SU/Cia da Viatura</h3>
            <p>{{ viatura.su_cia_da_viatura }}</p>
          </ion-label>
        </ion-item>
      </ng-container>

      <!-- Se OS Fechada -->
      <ng-container *ngIf="viatura.situacao_os_encerrada === 'FECHADA'">
        <ion-item>
          <ion-icon name="document-text-outline" slot="start" color="success"></ion-icon>
          <ion-label>
            <h3>Número OS</h3>
            <p>{{ viatura.id_os }}</p>
          </ion-label>
        </ion-item>

        <ion-item>
          <ion-icon name="car-outline" slot="start" color="success"></ion-icon>
          <ion-label>
            <h3>Placa</h3>
            <p>{{ viatura.placa_eb}}</p>
          </ion-label>
        </ion-item>

        <ion-item>
          <ion-icon name="speedometer-outline" slot="start" color="success"></ion-icon>
          <ion-label>
            <h3>Hodômetro</h3>
            <p>{{ viatura.hodometro }} km</p>
          </ion-label>
        </ion-item>

        <ion-item>
          <ion-icon name="person-outline" slot="start" color="success"></ion-icon>
          <ion-label>
            <h3>Mecânico Responsável</h3>
            <p>{{ viatura.nome_mecanico | titlecase }}</p>
          </ion-label>
        </ion-item>

        <ion-item>
          <ion-icon name="time-outline" slot="start" color="success"></ion-icon>
          <ion-label>
            <h3>Tempo Total</h3>
            <p>{{ viatura.tempo_total || 'Não informado' }}</p>
          </ion-label>
        </ion-item>

        <ion-item>
          <ion-icon name="information-circle-outline" slot="start" color="success"></ion-icon>
          <ion-label>
            <h3>Problema Apresentado</h3>
            <p>{{ viatura.problema_apresentado }} ✅</p>
          </ion-label>
        </ion-item>
      </ng-container>
    </ion-list>

    <div class="acoes" *ngIf="viatura.situacao_os_aberta === 'ABERTA'">
      <ion-button expand="block" color="primary">
        <ion-icon name="construct-outline" slot="start"></ion-icon>
        Iniciar Manutenção
      </ion-button>
    </div>

    <div class="acoes" *ngIf="viatura.situacao_os_encerrada === 'FECHADA'">
      <ion-button expand="block" color="success">
        <ion-icon name="checkmark-circle-outline" slot="start"></ion-icon>
        Visualizar Relatório
      </ion-button>
    </div>
  </ion-card-content>
</ion-card>
